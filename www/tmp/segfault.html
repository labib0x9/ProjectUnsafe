<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Segmentation Fault â€” ProjectUnsafe</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%232d3436'/%3E%3Cpath d='M16 6l8.66 5v10L16 26l-8.66-5V11L16 6z' fill='none' stroke='%23ff8c00' stroke-width='2.5'/%3E%3Ccircle cx='16' cy='16' r='3' fill='%23ff8c00'/%3E%3C/svg%3E">
  <link rel="stylesheet" href="/static/style.css"/>
  <style>
    :root {
      --page-accent: #fb923c;           /* orange */
      --page-accent-rgb: 251,146,60;
    }

    .hero {
      padding: 5rem 2rem 3rem;
      max-width: 860px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.78rem;
      letter-spacing: 2px;
      color: var(--dim);
      text-decoration: none;
      margin-bottom: 2.5rem;
      transition: color 0.2s;
    }
    .back-link:hover { color: var(--page-accent); }
    .back-link::before { content: 'â†'; }

    .hero .section-label { margin-bottom: 0.8rem; color: var(--page-accent); }

    .hero h1 {
      font-size: clamp(2.4rem, 6vw, 4rem);
      font-weight: 800;
      color: #fff;
      line-height: 1.1;
      margin-bottom: 1.5rem;
    }
    .hero h1 span { color: var(--page-accent); }

    .desc-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 2.5rem;
    }
    @media (max-width: 600px) { .desc-grid { grid-template-columns: 1fr; } }

    .desc-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-left: 3px solid var(--page-accent);
      padding: 1.5rem;
    }
    .desc-card h3 {
      font-size: 0.7rem;
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 3px;
      color: var(--page-accent);
      text-transform: uppercase;
      margin-bottom: 0.8rem;
    }
    .desc-card p { font-size: 0.9rem; color: var(--dim); line-height: 1.75; }

    .impact-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1.8rem;
    }
    .pill {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.72rem;
      letter-spacing: 1.5px;
      padding: 0.3rem 0.8rem;
      border: 1px solid rgba(var(--page-accent-rgb), 0.35);
      color: var(--page-accent);
      background: rgba(var(--page-accent-rgb), 0.07);
    }

    .page-divider {
      max-width: 860px;
      margin: 0 auto 2rem;
      border: none;
      border-top: 1px solid var(--border);
    }

    /* â”€â”€ Labs â”€â”€ */
    .labs-section {
      max-width: 860px;
      margin: 0 auto;
      padding: 1rem 2rem 6rem;
    }
    .labs-section h2 {
      font-size: 1.4rem;
      font-weight: 800;
      color: #fff;
      margin-bottom: 0.4rem;
    }
    .labs-section > p {
      font-size: 0.85rem;
      color: var(--dim);
      margin-bottom: 2rem;
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 1px;
    }

    .lab-card {
      background: var(--surface);
      border: 1px solid var(--border);
      margin-bottom: 1rem;
      transition: border-color 0.25s;
    }
    .lab-card.open { border-color: var(--page-accent); }

    .lab-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.2rem 1.5rem;
      cursor: pointer;
      user-select: none;
      gap: 1rem;
    }
    .lab-header:hover .lab-title { color: var(--page-accent); }

    .lab-left { display: flex; align-items: center; gap: 1rem; }

    .lab-num {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.75rem;
      color: var(--page-accent);
      background: rgba(var(--page-accent-rgb), 0.1);
      border: 1px solid rgba(var(--page-accent-rgb), 0.25);
      padding: 0.2rem 0.55rem;
      min-width: 2.4rem;
      text-align: center;
    }

    .lab-title {
      font-size: 1rem;
      font-weight: 700;
      color: #fff;
      transition: color 0.2s;
    }

    .lab-badge {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.65rem;
      letter-spacing: 2px;
      padding: 0.18rem 0.55rem;
      border: 1px solid;
      text-transform: uppercase;
    }
    .badge-easy   { border-color: #4ade80; color: #4ade80; }
    .badge-medium { border-color: #facc15; color: #facc15; }
    .badge-hard   { border-color: #f87171; color: #f87171; }

    .lab-chevron {
      font-size: 1rem;
      color: var(--dim);
      transition: transform 0.3s;
      flex-shrink: 0;
    }
    .lab-card.open .lab-chevron { transform: rotate(180deg); color: var(--page-accent); }

    .lab-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
    .lab-card.open .lab-body { max-height: 600px; }

    .lab-body-inner {
      padding: 0 1.5rem 1.5rem;
      border-top: 1px solid var(--border);
    }

    .lab-desc {
      font-size: 0.88rem;
      color: var(--dim);
      line-height: 1.75;
      margin: 1.2rem 0 1.5rem;
    }

    .lab-actions { display: flex; gap: 1rem; flex-wrap: wrap; }

    .lab-btn {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.8rem;
      letter-spacing: 2px;
      padding: 0.6rem 1.4rem;
      border: none;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.2s;
    }
    .lab-btn:hover { opacity: 0.85; transform: translateY(-2px); }

    .btn-start { background: var(--page-accent); color: #000; font-weight: 700; }

    .btn-hint {
      background: transparent;
      border: 1px solid var(--dim);
      color: var(--dim);
    }
    .btn-hint:hover { border-color: #fff; color: #fff; }

    .hint-box {
      display: none;
      margin-top: 1.2rem;
      background: rgba(167,139,250,0.07);
      border: 1px solid rgba(167,139,250,0.25);
      border-left: 3px solid var(--accent3);
      padding: 1rem 1.2rem;
    }
    .hint-box.visible { display: block; }
    .hint-box p {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.8rem;
      color: var(--accent3);
      line-height: 1.7;
    }
    .hint-box p::before { content: 'ðŸ’¡ HINT: '; opacity: 0.6; }

    code {
      font-family: 'Share Tech Mono', monospace;
      color: var(--page-accent);
      font-size: 0.85em;
    }
  </style>
</head>
<body>

<!-- â”€â”€ HERO â”€â”€ -->
<section class="hero reveal">
  <a href="index.html" class="back-link"> Back to Topics</a>
  <p class="section-label">// Memory Error Â· Segfault</p>
  <h1>Segmentation<br/><span>Fault</span></h1>

  <p style="color:var(--dim);font-size:1rem;line-height:1.8;max-width:680px;">
    A segmentation fault is the operating system's way of telling a program: "you just
    touched memory that isn't yours." It's a crash â€” but in security, crashes are doorways.
    Understanding why a program segfaults is the first step toward understanding buffer
    overflows, stack smashing, and arbitrary code execution.
  </p>

  <div class="desc-grid">
    <div class="desc-card">
      <h3>What It Is</h3>
      <p>
        When a program accesses a memory address it has no permission to read or write â€”
        whether through a buffer overflow, a dangling pointer, or an off-by-one error â€”
        the kernel raises a <strong style="color:#fff">SIGSEGV</strong> signal and terminates
        the process. In C and C++, the absence of memory safety means these bugs are
        common and routinely exploitable. The stack, heap, and BSS segments each have
        distinct classes of vulnerabilities with different exploitation techniques.
      </p>
    </div>
    <div class="desc-card">
      <h3>Impact</h3>
      <p>
        Memory corruption vulnerabilities can lead to <strong style="color:#fff">arbitrary code execution</strong>
        â€” the attacker controls the instruction pointer and runs shellcode or ROP chains
        with the privileges of the vulnerable process. Real-world examples include
        Heartbleed, EternalBlue, and Log4Shell. Even a "simple" segfault in a
        setuid binary or network daemon can mean full system compromise.
      </p>
    </div>
  </div>

  <div class="impact-pills">
    <span class="pill">ARBITRARY CODE EXEC</span>
    <span class="pill">STACK SMASHING</span>
    <span class="pill">HEAP CORRUPTION</span>
    <span class="pill">ROP CHAINS</span>
    <span class="pill">PRIVILEGE ESCALATION</span>
    <span class="pill">PROCESS CRASH / DoS</span>
  </div>
</section>

<hr class="page-divider"/>

<!-- â”€â”€ LABS â”€â”€ -->
<section class="labs-section">
  <h2>Labs</h2>
  <p>// 4 challenges Â· click to expand Â· complete in order</p>

  <!-- Lab 1 -->
  <div class="lab-card" id="lab1">
    <div class="lab-header" onclick="toggleLab('lab1')">
      <div class="lab-left">
        <span class="lab-num">01</span>
        <span class="lab-title">Trigger Your First Segfault</span>
        <span class="lab-badge badge-easy">EASY</span>
      </div>
      <span class="lab-chevron">â–¼</span>
    </div>
    <div class="lab-body">
      <div class="lab-body-inner">
        <p class="lab-desc">
          You are given a C program that reads user input into a fixed-size stack buffer using
          <code>gets()</code> â€” a function so dangerous it was removed from the C standard.
          Your task is to send enough bytes to overflow the buffer, overwrite adjacent stack
          memory, and crash the program with a segfault. Observe the crash in GDB and identify
          which part of the stack was corrupted.
        </p>
        <div class="lab-actions">
          <button class="lab-btn btn-start" onclick="startLab(1)">â–¶ START LAB</button>
          <button class="lab-btn btn-hint" onclick="toggleHint('hint1', this)">HINT</button>
        </div>
        <div class="hint-box" id="hint1">
          <p>Run the binary inside GDB: <code>gdb ./vuln</code>. Feed it a long string with <code>python3 -c "print('A'*200)"</code> piped to stdin. When it crashes, run <code>info registers</code> to see RIP/EIP. Look for <code>0x41414141</code> â€” that's your 'A's overwriting the return address.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Lab 2 -->
  <div class="lab-card" id="lab2">
    <div class="lab-header" onclick="toggleLab('lab2')">
      <div class="lab-left">
        <span class="lab-num">02</span>
        <span class="lab-title">Stack Buffer Overflow â€” Control EIP/RIP</span>
        <span class="lab-badge badge-easy">EASY</span>
      </div>
      <span class="lab-chevron">â–¼</span>
    </div>
    <div class="lab-body">
      <div class="lab-body-inner">
        <p class="lab-desc">
          With ASLR and stack canaries disabled, precisely overwrite the saved return address
          on the stack to redirect execution to a <code>win()</code> function that was never
          called by the program. Use a cyclic pattern to determine the exact offset before
          the return address, then craft a payload that lands exactly on the target address.
        </p>
        <div class="lab-actions">
          <button class="lab-btn btn-start" onclick="startLab(2)">â–¶ START LAB</button>
          <button class="lab-btn btn-hint" onclick="toggleHint('hint2', this)">HINT</button>
        </div>
        <div class="hint-box" id="hint2">
          <p>Use <code>pwndbg</code> or <code>pwntools</code>: generate a cyclic pattern with <code>cyclic 200</code>, crash the binary, find the offset with <code>cyclic -l [value in RBP/RSP]</code>. Then: <code>payload = b'A'*offset + p64(win_address)</code>.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Lab 3 -->
  <div class="lab-card" id="lab3">
    <div class="lab-header" onclick="toggleLab('lab3')">
      <div class="lab-left">
        <span class="lab-num">03</span>
        <span class="lab-title">Shellcode Injection on the Stack</span>
        <span class="lab-badge badge-medium">MEDIUM</span>
      </div>
      <span class="lab-chevron">â–¼</span>
    </div>
    <div class="lab-body">
      <div class="lab-body-inner">
        <p class="lab-desc">
          The stack is executable (NX disabled) and ASLR is off. There is no pre-written
          <code>win()</code> function â€” you must write your own shellcode, inject it into the
          buffer, and redirect execution to it. Your shellcode should spawn <code>/bin/sh</code>.
          Use GDB to find the stack address of your buffer and build the exploit payload.
        </p>
        <div class="lab-actions">
          <button class="lab-btn btn-start" onclick="startLab(3)">â–¶ START LAB</button>
          <button class="lab-btn btn-hint" onclick="toggleHint('hint3', this)">HINT</button>
        </div>
        <div class="hint-box" id="hint3">
          <p>Use a standard x86-64 <code>execve("/bin/sh")</code> shellcode (or generate one with <code>pwntools shellcraft</code>). In GDB, set a breakpoint after the <code>gets()</code> call and run <code>x/40x $rsp</code> to find where your input lands. Point the return address there.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Lab 4 -->
  <div class="lab-card" id="lab4">
    <div class="lab-header" onclick="toggleLab('lab4')">
      <div class="lab-left">
        <span class="lab-num">04</span>
        <span class="lab-title">ROP Chain to Bypass NX &amp; Stack Canary</span>
        <span class="lab-badge badge-hard">HARD</span>
      </div>
      <span class="lab-chevron">â–¼</span>
    </div>
    <div class="lab-body">
      <div class="lab-body-inner">
        <p class="lab-desc">
          The binary is now compiled with <strong style="color:#fff">NX enabled</strong> (no executable stack)
          and a <strong style="color:#fff">stack canary</strong> protecting the return address.
          You must first leak the canary value via a format string bug,
          then bypass NX by chaining existing executable gadgets (ROP) to call
          <code>system("/bin/sh")</code> using gadgets from libc â€” without injecting a single byte of shellcode.
        </p>
        <div class="lab-actions">
          <button class="lab-btn btn-start" onclick="startLab(4)">â–¶ START LAB</button>
          <button class="lab-btn btn-hint" onclick="toggleHint('hint4', this)">HINT</button>
        </div>
        <div class="hint-box" id="hint4">
          <p>Leak the canary with <code>%7$p</code> (or the right stack offset) via the format string. Find ROP gadgets with <code>ROPgadget --binary ./vuln</code> or <code>ropper</code>. Chain: <code>pop rdi; ret â†’ "/bin/sh" address â†’ system()</code>. Use <code>pwntools</code> to automate.</p>
        </div>
      </div>
    </div>
  </div>

</section>

<script>
  function toggleLab(id) {
    document.getElementById(id).classList.toggle('open');
  }
  function toggleHint(hintId, btn) {
    const visible = document.getElementById(hintId).classList.toggle('visible');
    btn.textContent = visible ? 'HIDE HINT' : 'HINT';
  }
  function startLab(num) {
    alert('Launching Lab ' + num + '...\n(Connect this button to your lab environment URL.)');
  }
  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.1 });
  document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
</body>
</html>
